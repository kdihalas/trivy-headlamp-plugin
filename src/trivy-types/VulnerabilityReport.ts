import { Metadata } from './Metadata';

export interface VulnerabilityReport {
  apiVersion: string;
  kind: string;
  metadata: Metadata;
  report: VulnerabilityReport.Report;
}

export namespace VulnerabilityReport {
  export interface Report {
    artifact: Artifact;
    os: OS;
    registry: Registry;
    scanner: Scanner;
    summary: Summary;
    updateTimestamp: Date;
    vulnerabilities: Vulnerability[];
  }

  export interface Artifact {
    digest?: string;
    repository: string;
    tag?: string;
  }

  export interface OS {
    family: string;
    name: string;
  }

  export interface Registry {
    server: string;
  }

  export interface Scanner {
    name: string;
    vendor: string;
    version: string;
  }

  export interface Summary {
    criticalCount: number;
    highCount: number;
    lowCount: number;
    mediumCount: number;
    noneCount: number;
    unknownCount: number;
  }

  export interface Vulnerability {
    fixedVersion?: string;
    installedVersion: string;
    lastModifiedDate: string;
    links: string[];
    primaryLink: string;
    publishedDate: string;
    resource: string;
    score: number;
    severity: Severity;
    target: string;
    title?: string;
    vulnerabilityID: string;
  }

  export enum Severity {
    Critical = 'CRITICAL',
    High = 'HIGH',
    Low = 'LOW',
    Medium = 'MEDIUM',
  }
}
